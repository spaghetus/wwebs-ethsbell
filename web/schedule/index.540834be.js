document.querySelector("#table"),document.querySelector("#tbody");const e=document.querySelector("#schedule-select"),t=document.querySelector("#date-select"),a=document.querySelector("#calendar-table");let n={},o={};async function d(t=current_date(),a=!1){const n="string"==typeof t?t:date_to_string(t,!1),d=await get(`/api/v1/on/${n}`);if(d){place_boxes(d,"string"==typeof t?date_string_to_date(t,!0):t,!0,a||n===date_to_string(current_date(),!1)),a&&(o=d);for(const t of e.querySelectorAll("option"))t.textContent===d.friendly_name&&(t.selected=!0)}}getel("today").addEventListener("click",(()=>{t.value=date_to_string(current_date(),!1),d(t.value)})),getel("previous").addEventListener("click",(()=>{t.valueAsDate=new Date(t.valueAsDate.getTime()-864e5),d(t.value)})),getel("next").addEventListener("click",(()=>{t.valueAsDate=new Date(t.valueAsDate.getTime()+864e5),d(t.value)}));let r=[];function c(t){e.innerHTML="";for(const a of r.filter((e=>!e.hide||t===e.code))){const n=document.createElement("option");n.value=a.code,t===a.code&&(n.selected=!0),(a.hide||0===a.periods.length)&&(n.disabled=!0),n.innerHTML=a.friendly_name,e.append(n)}}e.addEventListener("change",(()=>{const t=e.value;n[t]&&place_boxes(n[t],current_date(),!0,e.options[e.selectedIndex].text===o.friendly_name)})),t.value=date_to_string(current_date(),!1),t.addEventListener("change",(()=>{d(t.value)}));const l=current_date();l.setHours(0,0,0,0),l.setDate(l.getDate()-l.getDay());const s=new Date(l);s.setDate(s.getDate()+28),t.min=date_to_string(l,!1),t.max=date_to_string(new Date(s.getTime()-86400),!1),(async()=>{await d(current_date(),!0),await async function(){var t;const a=await get("/api/v1/spec");if(!a)return;n=a.schedule_types,e.innerHTML='<option value="" disabled selected>Select a Schedule</option>',r=Object.keys(n).map((e=>Object.assign({code:e},n[e]))).sort(((e,t)=>!e.hide&&t.hide||0===e.periods.length?1:e.hide&&!t.hide||0===t.periods.length?-1:e.friendly_name.localeCompare(t.friendly_name))),c(o&&(null===(t=r.find((e=>e.friendly_name===o.friendly_name)))||void 0===t?void 0:t.code)||null)}();const i=await async function(e,t){const a=await get(`/api/v1/schedule/from/${date_to_string(e,!1)}/to/${date_to_string(t,!1)}`);if(!n)return;return a.map(((t,a)=>{const o=new Date(e);o.setDate(o.getDate()+a);let d=n[t]||null;if(!d)try{d=JSON.parse(t)}catch{}const r=(null==d?void 0:d.friendly_name)||null,c=(null==d?void 0:d.color)?bytes_to_color(d.color):"#FFFFFF";return{code:t,data:d,name:r,date:o,backgroundColor:c,textColor:black_or_white(c)}}))}(l,s);a.innerHTML="";const u=document.createElement("table"),_=document.createElement("tbody");let g=0;for(let e=0;e<4;e++){const e=document.createElement("tr");for(let a=0;a<7;a++){const a=document.createElement("td"),n=i[g],o=n.date.toLocaleDateString("en-US",{weekday:"short",month:"long",day:"numeric"});a.classList.add("day"),a.innerHTML=`<span class="day-name">${o}</span><div class="day-schedule">${n.name}</div>`,n.date.toLocaleDateString()===current_date().toLocaleDateString()&&a.classList.add("today"),a.querySelector(".day-schedule").style.backgroundColor=n.backgroundColor,a.querySelector(".day-schedule").style.color=n.textColor,0===n.data.periods.length?a.classList.add("no-periods"):a.addEventListener("click",(()=>{place_boxes(n.data,n.date,!0,n.date.toLocaleDateString()===current_date().toLocaleDateString()),c(n.code),t.value=date_to_string(n.date)})),e.append(a),g++}_.append(e)}u.append(_),a.append(u)})();
//# sourceMappingURL=index.540834be.js.map

{"mappings":"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","sources":["frontend/global/helpers.js"],"sourcesContent":["const DEFAULT_CONFIG = {\n\tschedule: {},\n\tforeground_color: '#1a2741',\n\tbackground_color: '#c34614',\n\tforeground_text_color: '#ffffff',\n\tbackground_text_color: '#ffffff',\n\tinclude_period_name: true,\n\tuse_schedule_color: true,\n};\n\n// Start helpers\nlet lastFetchedData = null;\nconst serverOffset = null;\n\nasync function get(endpoint = '/api/v1/today/now/near') {\n\treturn fetch(\n\t\t`${endpoint}?timestamp=${Math.floor(current_date().getTime() / 1000)}`,\n\t)\n\t\t.then(x => x.json().catch(() => null))\n\t\t.catch(() => null);\n}\n\nlet config;\nfunction updateConfig() {\n\tconfig = Object.assign(\n\t\tDEFAULT_CONFIG,\n\t\tJSON.parse(localStorage.getItem('schedule') || '{}'),\n\t);\n\treturn config;\n}\n\nupdateConfig();\n\nfunction replace_period(period) {\n\tif (!period) {\n\t\treturn period;\n\t}\n\n\tif (Array.isArray(period)) {\n\t\treturn period.map(v => replace_period(v));\n\t}\n\n\tconst period_tmp = Object.assign({}, period);\n\n\tconst class_id = period_tmp.kind.Class || period_tmp.kind.ClassOrLunch;\n\tconst class_cfg\n\t\t= config.schedule[class_id] || config.schedule[period_tmp.friendly_name];\n\tif (class_cfg) {\n\t\tif (class_cfg.name) {\n\t\t\tperiod_tmp.friendly_name\n\t\t\t\t= config.include_period_name\n\t\t\t\t|| config.include_period_name === undefined\n\t\t\t\t\t? `${period_tmp.friendly_name} - ${class_cfg.name}`\n\t\t\t\t\t: class_cfg.name;\n\t\t}\n\n\t\tif (class_cfg.url) {\n\t\t\tperiod_tmp.url = class_cfg.url;\n\t\t}\n\t}\n\n\treturn period_tmp;\n}\n\nfunction process(data) {\n\tif (config) {\n\t\treturn data.map(v => replace_period(v));\n\t}\n\n\treturn data;\n}\n\nfunction period_html(period) {\n\treturn period\n\t\t? (period.url\n\t\t\t? `<a href=${period.url}>${period.friendly_name\n\t\t\t\t.replaceAll('<', '&lt;')\n\t\t\t\t.replaceAll('>', '&gt;')}</a>`\n\t\t\t: period.friendly_name\n\t\t\t\t.replaceAll('<', '&lt;')\n\t\t\t\t.replaceAll('>', '&gt;'))\n\t\t: 'None';\n}\n\nfunction getel(id) {\n\treturn document.querySelector(`#${id}`);\n}\n\nasync function go(display) {\n\tif (lastFetchedData) {\n\t\tdisplay(lastFetchedData);\n\t}\n\n\tconst now = Date.now();\n\tconst endOfMinute = Math.ceil(now / 60000) * 60000;\n\tsetTimeout(() => go(display), endOfMinute - now);\n\tlet data = await get();\n\tif (!data) {\n\t\treturn;\n\t}\n\n\tdata = process(data);\n\tlastFetchedData = data;\n\tdisplay(data);\n}\n\nfunction human_list(items) {\n\tlet output = '';\n\tif (items.length === 1) {\n\t\treturn items[0].toString();\n\t}\n\n\tfor (let i = 0; i < items.length; i++) {\n\t\tif (i === items.length - 1) {\n\t\t\toutput += `${items.length > 2 ? ', ' : ' '}and ${items[\n\t\t\t\ti\n\t\t\t].toString()}`;\n\t\t} else if (i === 0) {\n\t\t\toutput += items[i].toString();\n\t\t} else {\n\t\t\toutput += `, ${items[i].toString()}`;\n\t\t}\n\t}\n\n\treturn output;\n}\n\n// Add plural suffix to a unit\nfunction plural_suffix(number, string) {\n\treturn `${string}${number === 1 ? '' : 's'}`;\n}\n\n// Gets current date\n// If timestamp query string is provided, that is used instead of current.\nfunction current_date() {\n\tconst timestampQueryString = new URLSearchParams(\n\t\twindow.location.search,\n\t).get('timestamp');\n\tif (timestampQueryString) {\n\t\treturn new Date(Number.parseInt(timestampQueryString, 10) * 1000);\n\t}\n\n\treturn new Date();\n}\n\nfunction date_from_api(time, now = current_date()) {\n\tconst [h, m, s] = time.split(':');\n\tconst date = new Date(\n\t\tnow.getUTCFullYear(),\n\t\tnow.getUTCMonth(),\n\t\tnow.getUTCDate(),\n\t\th,\n\t\tm,\n\t\ts,\n\t);\n\treturn date;\n}\n\n// YYYY-MM-DD to Date object\nfunction date_string_to_date(dateString) {\n\tconst [y, m, d] = dateString.split('-');\n\treturn new Date(\n\t\tNumber.parseInt(y, 10),\n\t\tNumber.parseInt(m, 10) - 1,\n\t\tNumber.parseInt(d, 10),\n\t);\n}\n\nfunction human_time(time) {\n\tconst date = date_from_api(time);\n\treturn date.toLocaleTimeString('en-US', {\n\t\thour: 'numeric',\n\t\tminute: '2-digit',\n\t});\n}\n\n// Gets a human readable duration from an epoch timestamp\nfunction human_time_left(endTime, startTime = null, short = false) {\n\tconst startDate = startTime\n\t\t? date_from_api(startTime).getTime()\n\t\t: current_date().getTime();\n\tconst endDate = date_from_api(endTime).getTime();\n\tconst timeLeft = Math.floor((endDate - startDate) / 1000);\n\tconst h = Math.floor(timeLeft / 60 / 60);\n\tconst m = Math.ceil((timeLeft / 60) % 60);\n\tif (short) {\n\t\tif (h > 0) {\n\t\t\treturn `${h}h ${m}m`;\n\t\t}\n\n\t\treturn `${m}m`;\n\t}\n\n\tif (h > 0) {\n\t\treturn `${h} ${plural_suffix(h, 'hour')} and ${m} ${plural_suffix(\n\t\t\tm,\n\t\t\t'minute',\n\t\t)}`;\n\t}\n\n\treturn `${m} ${plural_suffix(m, 'minute')}`;\n}\n\n// Convert date object to YYYY-MM-DD\nfunction date_to_string(date = current_date(), utc = true) {\n\tif (utc) {\n\t\treturn `${date.getUTCFullYear()}-${(\n\t\t\t'0'\n\t\t\t+ (date.getUTCMonth() + 1)\n\t\t).slice(-2)}-${('0' + date.getUTCDate()).slice(-2)}`;\n\t}\n\n\treturn `${date.getFullYear()}-${('0' + (date.getMonth() + 1)).slice(-2)}-${(\n\t\t'0' + date.getDate()\n\t).slice(-2)}`;\n}\n\n// Helper functions for full screen\nfunction enterFullScreen(element = document.documentElement) {\n\tif (element.requestFullscreen) {\n\t\telement.requestFullscreen();\n\t} else if (element.webkitRequestFullscreen) {\n\t\telement.webkitRequestFullscreen();\n\t} else if (element.mozRequestFullScreen) {\n\t\telement.mozRequestFullScreen();\n\t} else if (element.msRequestFullscreen) {\n\t\telement.msRequestFullscreen();\n\t}\n}\n\nfunction exitFullscreen() {\n\tif (document.exitFullscreen) {\n\t\tdocument.exitFullscreen();\n\t} else if (document.webkitExitFullscreen) {\n\t\tdocument.webkitExitFullscreen();\n\t} else if (document.mozExitFullScreen) {\n\t\tdocument.mozExitFullScreen();\n\t} else if (document.msExitFullscreen) {\n\t\tdocument.msExitFullscreen();\n\t}\n}\n\nfunction canFullScreen() {\n\treturn (\n\t\tdocument.fullscreenEnabled\n\t\t|| document.mozFullScreenEnabled\n\t\t|| document.webkitFullscreenEnabled\n\t\t|| document.msFullscreenEnabled\n\t);\n}\n\nfunction isFullScreen() {\n\treturn (\n\t\t(document.fullscreenElement\n\t\t\t|| document.mozFullScreenElement\n\t\t\t|| document.webkitIsFullScreen\n\t\t\t|| document.msFullscreenElement\n\t\t\t|| null) !== null\n\t);\n}\n\nfunction toggleFullScreen(element) {\n\tif (canFullScreen()) {\n\t\tif (isFullScreen()) {\n\t\t\texitFullscreen();\n\t\t} else {\n\t\t\tenterFullScreen(element);\n\t\t}\n\t}\n}\n\nwindow.addEventListener('load', () => {\n\tif (!document.querySelector('nav')) {\n\t\treturn;\n\t}\n\n\tconst nav_links = document.querySelector('#nav-links');\n\tdocument\n\t\t.querySelector('#nav-toggle-button')\n\t\t.addEventListener('click', () => {\n\t\t\tnav_links.classList.toggle('show');\n\t\t\tnav_links.style.maxHeight = nav_links.classList.contains('show')\n\t\t\t\t? nav_links.querySelector('ul').clientHeight + 'px'\n\t\t\t\t: '';\n\t\t});\n});\n\nwindow.addEventListener('resize', () => {\n\tif (!document.querySelector('nav')) {\n\t\treturn;\n\t}\n\n\tconst nav_links = document.querySelector('#nav-links');\n\tif (nav_links.classList.contains('show')) {\n\t\tnav_links.style.maxHeight\n\t\t\t= nav_links.querySelector('ul').clientHeight + 'px';\n\t}\n});\n\n// Convert array of RGB to hex\nfunction bytes_to_color(bytes) {\n\treturn '#' + bytes.map(b => ('0' + b.toString(16)).slice(-2)).join('');\n}\n\n// Detect whether text should be black or white based on the background color\nfunction black_or_white(color, opacity = 1) {\n\tif (!color.startsWith('#')) {\n\t\tcolor = `#${color}`;\n\t}\n\n\tconst r = Number.parseInt(color.slice(1, 3), 16);\n\tconst g = Number.parseInt(color.slice(3, 5), 16);\n\tconst b = Number.parseInt(color.slice(5, 7), 16);\n\tconst luma = 0.2126 * r + 0.7152 * g + 0.0722 * b;\n\treturn luma > 128\n\t\t? `rgba(0, 0, 0, ${opacity})`\n\t\t: `rgba(255, 255, 255, ${opacity})`;\n}\n\nasync function getServerOffset() {\n\tconst response = await fetch('/api/v1/what-time-is-it');\n\tconst data = await response.text();\n\tconst offset = data.split(' ')[5];\n\tconst h = Number.parseInt(offset.slice(0, -2), 10);\n\tconst m = Number.parseInt(offset.slice(-2), 10);\n\tconst serverUTCOffset = h * 60 + m;\n\tconst utcOffset = new Date().getTimezoneOffset();\n\tconst serverOffset = -serverUTCOffset - utcOffset;\n\treturn serverOffset * 60 * 1000;\n}\n\n// Apply user colors\nwindow.addEventListener('load', () => {\n\tsetTheme();\n});\n\nfunction setTheme() {\n\tconst cfg = config || {};\n\tconst setBg = !(window.location.pathname === '/' && cfg.use_schedule_color);\n\n\tdocument\n\t\t.querySelector('meta[name=theme-color]')\n\t\t.setAttribute('content', cfg.foreground_color || '#1a2741');\n\n\tif (setBg && cfg.background_color) {\n\t\tdocument\n\t\t\t.querySelector('body')\n\t\t\t.style.setProperty('--background_color', cfg.background_color || '#c34614');\n\t}\n\n\tif (cfg.foreground_color) {\n\t\tdocument\n\t\t\t.querySelector('body')\n\t\t\t.style.setProperty('--foreground_color', cfg.foreground_color || '#1a2741');\n\t}\n\n\tif (setBg && cfg.background_text_color) {\n\t\tdocument\n\t\t\t.querySelector('body')\n\t\t\t.style.setProperty(\n\t\t\t\t'--background_text_color',\n\t\t\t\tcfg.background_text_color || '#ffffff',\n\t\t\t);\n\t}\n\n\tif (cfg.foreground_text_color) {\n\t\tdocument\n\t\t\t.querySelector('body')\n\t\t\t.style.setProperty(\n\t\t\t\t'--foreground_text_color',\n\t\t\t\tcfg.foreground_text_color || '#ffffff',\n\t\t\t);\n\t}\n}\n\nfunction broadcastConfigToExtension() {\n\tupdateConfig();\n\tif (\n\t\ttypeof chrome !== 'undefined'\n\t\t&& typeof chrome.runtime !== 'undefined'\n\t) {\n\t\tchrome.runtime.sendMessage('gbkjjbecehodfeijbdmoieepgmfdlgle', {\n\t\t\tmessage: 'schedule',\n\t\t\tdata: JSON.stringify(config),\n\t\t});\n\t}\n}\n\nfunction setCookie(name, value, expires = (2 ** 31 * 1000), path = '/') {\n\tdocument.cookie = `${name}=${encodeURIComponent(value)}; ${\n\t\texpires ? `expires=${new Date(expires).toUTCString()}; ` : ''\n\t}path=${path}`;\n}\n\nfunction getCookie(name) {\n\treturn document.cookie.split('; ').reduce((r, v) => {\n\t\tconst parts = v.split('=');\n\t\treturn parts[0] === name ? decodeURIComponent(parts[1]) : r;\n\t}, '');\n}\n\nfunction deleteCookie(name, path) {\n\tsetCookie(name, '', null, path);\n}\n\nbroadcastConfigToExtension();\n\nObject.assign(window, {\n\tblack_or_white,\n\tbytes_to_color,\n\tcanFullScreen,\n\tcurrent_date,\n\tdate_from_api,\n\tdate_string_to_date,\n\tdate_to_string,\n\tenterFullScreen,\n\texitFullscreen,\n\tget,\n\tgetel,\n\tgo,\n\thuman_list,\n\thuman_time,\n\thuman_time_left,\n\tisFullScreen,\n\tperiod_html,\n\tplural_suffix,\n\tprocess,\n\treplace_period,\n\ttoggleFullScreen,\n\tput_period_to_element,\n\tsetTheme,\n\tbroadcastConfigToExtension,\n\tsetCookie,\n\tgetCookie,\n\tdeleteCookie,\n\tconfig,\n\tDEFAULT_CONFIG,\n});\n\n// Writes a period to an element and its children\nfunction put_period_to_element(element, period) {\n\tif (period) {\n\t\tif (period.kind === 'BeforeSchool') {\n\t\t\telement.innerHTML = 'School hasn\\'t started yet!';\n\t\t\treturn false;\n\t\t}\n\n\t\tif (period.kind === 'AfterSchool') {\n\t\t\telement.innerHTML = 'School\\'s out!';\n\t\t\treturn false;\n\t\t}\n\n\t\telement.innerHTML = element.innerHTML\n\t\t\t.replaceAll('{START}', human_time(period.start))\n\t\t\t.replaceAll('{END}', human_time(period.end))\n\t\t\t.replaceAll(\n\t\t\t\t'{START_IN}',\n\t\t\t\thuman_time_left(period.start, undefined, true),\n\t\t\t)\n\t\t\t.replaceAll(\n\t\t\t\t'{END_IN}',\n\t\t\t\thuman_time_left(period.end, undefined, true),\n\t\t\t)\n\t\t\t.replaceAll(\n\t\t\t\t'{NAME}',\n\t\t\t\tperiod.url\n\t\t\t\t\t? `<a href=\"${period.url}\">${period.friendly_name}</a>`\n\t\t\t\t\t: period.friendly_name,\n\t\t\t);\n\t\treturn true;\n\t}\n\n\telement.innerHTML = 'No School';\n\treturn false;\n}\n\nif (new URLSearchParams(\n\twindow.location.search,\n).get('fullscreen') !== null) {\n\tdocument.querySelector('nav').style.display = 'none';\n}\n"],"names":["$b97f8f2204dc70d3$var$DEFAULT_CONFIG","schedule","foreground_color","background_color","foreground_text_color","background_text_color","include_period_name","use_schedule_color","$b97f8f2204dc70d3$var$lastFetchedData","async","$b97f8f2204dc70d3$var$get","endpoint","fetch","Math","floor","$b97f8f2204dc70d3$var$current_date","getTime","then","x","json","catch","$b97f8f2204dc70d3$var$config","$b97f8f2204dc70d3$var$updateConfig","Object","assign","JSON","parse","localStorage","getItem","$b97f8f2204dc70d3$var$replace_period","period","Array","isArray","map","v","period_tmp","class_id","kind","Class","ClassOrLunch","class_cfg","friendly_name","name","undefined","url","$b97f8f2204dc70d3$var$process","data","$b97f8f2204dc70d3$var$plural_suffix","number","string","timestampQueryString","URLSearchParams","window","location","search","get","Date","Number","parseInt","$b97f8f2204dc70d3$var$date_from_api","time","now","h","m","s","split","getUTCFullYear","getUTCMonth","getUTCDate","$b97f8f2204dc70d3$var$human_time","toLocaleTimeString","hour","minute","$b97f8f2204dc70d3$var$human_time_left","endTime","startTime","short","startDate","endDate","timeLeft","ceil","$b97f8f2204dc70d3$var$enterFullScreen","element","document","documentElement","requestFullscreen","webkitRequestFullscreen","mozRequestFullScreen","msRequestFullscreen","$b97f8f2204dc70d3$var$exitFullscreen","exitFullscreen","webkitExitFullscreen","mozExitFullScreen","msExitFullscreen","$b97f8f2204dc70d3$var$canFullScreen","fullscreenEnabled","mozFullScreenEnabled","webkitFullscreenEnabled","msFullscreenEnabled","$b97f8f2204dc70d3$var$isFullScreen","fullscreenElement","mozFullScreenElement","webkitIsFullScreen","msFullscreenElement","$b97f8f2204dc70d3$var$setTheme","cfg","setBg","pathname","querySelector","setAttribute","style","setProperty","$b97f8f2204dc70d3$var$broadcastConfigToExtension","chrome","runtime","sendMessage","message","stringify","$b97f8f2204dc70d3$var$setCookie","value","expires","path","cookie","encodeURIComponent","toUTCString","addEventListener","nav_links","classList","toggle","maxHeight","contains","clientHeight","color","opacity","startsWith","slice","bytes","b","toString","join","dateString","y","d","date","utc","getFullYear","getMonth","getDate","id","$b97f8f2204dc70d3$var$go","display","endOfMinute","setTimeout","items","output","length","i","replaceAll","innerHTML","start","end","reduce","r","parts","decodeURIComponent"],"version":3,"file":"prelude.4fa1016d.js.map"}